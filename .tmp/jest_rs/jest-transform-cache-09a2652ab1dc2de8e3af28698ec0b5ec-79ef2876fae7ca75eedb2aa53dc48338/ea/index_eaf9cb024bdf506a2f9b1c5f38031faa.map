{"version":3,"names":["AudioDetectionModule","emitter","_require","require","NativeModulesProxy","EventEmitter","_unused","mockStartListening","mockStopListening","mockAddListener","_listener","remove","startListening","exports","stopListening","addListener","listener"],"sources":["index.ts"],"sourcesContent":["// Audio Detection Module Bridge\n// Provides startListening, stopListening, and addListener functions\n// Uses native module when available, falls back to mocks for testing\n\nexport type DetectedPitchEvent = {\n  pitches: { note: string; frequency: number; confidence: number }[];\n  timestamp: number;\n};\n\nexport type Subscription = {\n  remove: () => void;\n};\n\n// Check if we're in a native environment with the module available\nlet AudioDetectionModule: {\n  startListening: () => void;\n  stopListening: () => void;\n} | null = null;\n\nlet emitter: {\n  addListener: (eventName: string, listener: (event: DetectedPitchEvent) => void) => Subscription;\n} | null = null;\n\ntry {\n  // Attempt to import native modules - this will fail in test environment\n  const { NativeModulesProxy, EventEmitter } = require('expo-modules-core');\n  if (NativeModulesProxy?.AudioDetectionModule) {\n    AudioDetectionModule = NativeModulesProxy.AudioDetectionModule;\n    emitter = new EventEmitter(AudioDetectionModule);\n  }\n} catch {\n  // Native modules not available (test environment or web)\n}\n\n// Mock implementations for testing when native module is unavailable\nconst mockStartListening = (): void => {\n  // No-op in test/mock environment\n};\n\nconst mockStopListening = (): void => {\n  // No-op in test/mock environment\n};\n\nconst mockAddListener = (_listener: (event: DetectedPitchEvent) => void): Subscription => {\n  // Return a mock subscription\n  return {\n    remove: () => {\n      // No-op\n    },\n  };\n};\n\n// Export functions that use native module when available, otherwise use mocks\nexport const startListening = (): void => {\n  if (AudioDetectionModule) {\n    AudioDetectionModule.startListening();\n  } else {\n    mockStartListening();\n  }\n};\n\nexport const stopListening = (): void => {\n  if (AudioDetectionModule) {\n    AudioDetectionModule.stopListening();\n  } else {\n    mockStopListening();\n  }\n};\n\nexport const addListener = (listener: (event: DetectedPitchEvent) => void): Subscription => {\n  if (emitter) {\n    return emitter.addListener('onDetectedPitches', listener);\n  } else {\n    return mockAddListener(listener);\n  }\n};\n"],"mappings":";;;;AAcA,IAAIA,oBAGI,GAAG,IAAI;AAEf,IAAIC,OAEI,GAAG,IAAI;AAEf,IAAI;EAEF,IAAAC,QAAA,GAA6CC,OAAO,CAAC,mBAAmB,CAAC;IAAjEC,kBAAkB,GAAAF,QAAA,CAAlBE,kBAAkB;IAAEC,YAAY,GAAAH,QAAA,CAAZG,YAAY;EACxC,IAAID,kBAAkB,YAAlBA,kBAAkB,CAAEJ,oBAAoB,EAAE;IAC5CA,oBAAoB,GAAGI,kBAAkB,CAACJ,oBAAoB;IAC9DC,OAAO,GAAG,IAAII,YAAY,CAACL,oBAAoB,CAAC;EAClD;AACF,CAAC,CAAC,OAAAM,OAAA,EAAM,CAER;AAGA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAA,EAAe,CAEvC,CAAC;AAED,IAAMC,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAA,EAAe,CAEtC,CAAC;AAED,IAAMC,eAAe,GAAG,SAAlBA,eAAeA,CAAIC,SAA8C,EAAmB;EAExF,OAAO;IACLC,MAAM,EAAE,SAARA,MAAMA,CAAA,EAAQ,CAEd;EACF,CAAC;AACH,CAAC;AAGM,IAAMC,cAAc,GAAAC,OAAA,CAAAD,cAAA,GAAG,SAAjBA,cAAcA,CAAA,EAAe;EACxC,IAAIZ,oBAAoB,EAAE;IACxBA,oBAAoB,CAACY,cAAc,CAAC,CAAC;EACvC,CAAC,MAAM;IACLL,kBAAkB,CAAC,CAAC;EACtB;AACF,CAAC;AAEM,IAAMO,aAAa,GAAAD,OAAA,CAAAC,aAAA,GAAG,SAAhBA,aAAaA,CAAA,EAAe;EACvC,IAAId,oBAAoB,EAAE;IACxBA,oBAAoB,CAACc,aAAa,CAAC,CAAC;EACtC,CAAC,MAAM;IACLN,iBAAiB,CAAC,CAAC;EACrB;AACF,CAAC;AAEM,IAAMO,WAAW,GAAAF,OAAA,CAAAE,WAAA,GAAG,SAAdA,WAAWA,CAAIC,QAA6C,EAAmB;EAC1F,IAAIf,OAAO,EAAE;IACX,OAAOA,OAAO,CAACc,WAAW,CAAC,mBAAmB,EAAEC,QAAQ,CAAC;EAC3D,CAAC,MAAM;IACL,OAAOP,eAAe,CAACO,QAAQ,CAAC;EAClC;AACF,CAAC","ignoreList":[]}