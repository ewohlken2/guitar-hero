f77d65d9e4c825978aa5279e9728fdaf
var _chords = require("../../src/constants/chords");
var _chordMatching = require("../../src/utils/chordMatching");
describe('normalizePitchClass', function () {
  it('converts flat notes to sharp equivalents', function () {
    expect((0, _chordMatching.normalizePitchClass)('Db')).toBe('C#');
    expect((0, _chordMatching.normalizePitchClass)('Eb')).toBe('D#');
    expect((0, _chordMatching.normalizePitchClass)('Gb')).toBe('F#');
    expect((0, _chordMatching.normalizePitchClass)('Ab')).toBe('G#');
    expect((0, _chordMatching.normalizePitchClass)('Bb')).toBe('A#');
  });
  it('returns natural notes unchanged', function () {
    expect((0, _chordMatching.normalizePitchClass)('C')).toBe('C');
    expect((0, _chordMatching.normalizePitchClass)('D')).toBe('D');
    expect((0, _chordMatching.normalizePitchClass)('E')).toBe('E');
    expect((0, _chordMatching.normalizePitchClass)('F')).toBe('F');
    expect((0, _chordMatching.normalizePitchClass)('G')).toBe('G');
    expect((0, _chordMatching.normalizePitchClass)('A')).toBe('A');
    expect((0, _chordMatching.normalizePitchClass)('B')).toBe('B');
  });
  it('returns sharp notes unchanged', function () {
    expect((0, _chordMatching.normalizePitchClass)('C#')).toBe('C#');
    expect((0, _chordMatching.normalizePitchClass)('D#')).toBe('D#');
    expect((0, _chordMatching.normalizePitchClass)('F#')).toBe('F#');
    expect((0, _chordMatching.normalizePitchClass)('G#')).toBe('G#');
    expect((0, _chordMatching.normalizePitchClass)('A#')).toBe('A#');
  });
  it('handles lowercase input', function () {
    expect((0, _chordMatching.normalizePitchClass)('db')).toBe('C#');
    expect((0, _chordMatching.normalizePitchClass)('eb')).toBe('D#');
    expect((0, _chordMatching.normalizePitchClass)('c')).toBe('C');
  });
});
describe('FLAT_TO_SHARP', function () {
  it('contains all flat to sharp mappings', function () {
    expect(_chordMatching.FLAT_TO_SHARP).toEqual({
      Db: 'C#',
      Eb: 'D#',
      Fb: 'E',
      Gb: 'F#',
      Ab: 'G#',
      Bb: 'A#',
      Cb: 'B'
    });
  });
});
describe('matchChordFromNotes', function () {
  var createPitches = function createPitches(notes) {
    return notes.map(function (note, index) {
      return {
        note: note,
        frequency: 440 + index * 100,
        confidence: 0.9
      };
    });
  };
  it('matches exact chord notes to a chord', function () {
    var pitches = createPitches(['C', 'E', 'G']);
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now());
    expect(result).not.toBeNull();
    expect(result == null ? void 0 : result.chord.primaryName).toBe('C');
    expect(result == null ? void 0 : result.score).toBe(1);
  });
  it('returns null when no pitches detected', function () {
    var result = (0, _chordMatching.matchChordFromNotes)([], _chords.chords, Date.now());
    expect(result).toBeNull();
  });
  it('returns null when notes do not match any chord well', function () {
    var pitches = createPitches(['C#']);
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now());
    expect(result).toBeNull();
  });
  it('handles flat notes by normalizing to sharps', function () {
    var pitches = createPitches(['F', 'Ab', 'C']);
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now());
    expect(result).not.toBeNull();
    expect(result == null ? void 0 : result.chord.primaryName).toBe('Fm');
  });
  it('calculates score based on note overlap', function () {
    var pitches = createPitches(['D', 'F#']);
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now());
    expect(result).not.toBeNull();
    expect(result.score).toBeLessThan(1);
    expect(result.score).toBeGreaterThan(0);
    expect(result.score).toBeCloseTo(2 / 3, 2);
  });
  it('includes timestamp in the result', function () {
    var timestamp = 1234567890;
    var pitches = createPitches(['C', 'E', 'G']);
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, timestamp);
    expect(result == null ? void 0 : result.timestamp).toBe(timestamp);
  });
  it('prefers chords with higher overlap scores', function () {
    var pitches = createPitches(['G', 'B', 'D']);
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now());
    expect(result).not.toBeNull();
    expect(result == null ? void 0 : result.chord.primaryName).toBe('G');
    expect(result == null ? void 0 : result.score).toBe(1);
  });
  it('handles duplicate detected notes', function () {
    var pitches = createPitches(['C', 'E', 'G', 'C', 'E']);
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now());
    expect(result).not.toBeNull();
    expect(result == null ? void 0 : result.chord.primaryName).toBe('C');
  });
  it('filters low confidence pitches', function () {
    var pitches = [{
      note: 'C',
      frequency: 261.63,
      confidence: 0.9
    }, {
      note: 'E',
      frequency: 329.63,
      confidence: 0.9
    }, {
      note: 'G',
      frequency: 392.0,
      confidence: 0.9
    }, {
      note: 'X',
      frequency: 100,
      confidence: 0.1
    }];
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now());
    expect(result).not.toBeNull();
    expect(result == null ? void 0 : result.chord.primaryName).toBe('C');
  });
  it('requires minimum confidence threshold', function () {
    var pitches = [{
      note: 'C',
      frequency: 261.63,
      confidence: 0.3
    }, {
      note: 'E',
      frequency: 329.63,
      confidence: 0.3
    }, {
      note: 'G',
      frequency: 392.0,
      confidence: 0.3
    }];
    var result = (0, _chordMatching.matchChordFromNotes)(pitches, _chords.chords, Date.now(), 0.5);
    expect(result).toBeNull();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY2hvcmRzIiwicmVxdWlyZSIsIl9jaG9yZE1hdGNoaW5nIiwiZGVzY3JpYmUiLCJpdCIsImV4cGVjdCIsIm5vcm1hbGl6ZVBpdGNoQ2xhc3MiLCJ0b0JlIiwiRkxBVF9UT19TSEFSUCIsInRvRXF1YWwiLCJEYiIsIkViIiwiRmIiLCJHYiIsIkFiIiwiQmIiLCJDYiIsImNyZWF0ZVBpdGNoZXMiLCJub3RlcyIsIm1hcCIsIm5vdGUiLCJpbmRleCIsImZyZXF1ZW5jeSIsImNvbmZpZGVuY2UiLCJwaXRjaGVzIiwicmVzdWx0IiwibWF0Y2hDaG9yZEZyb21Ob3RlcyIsImNob3JkcyIsIkRhdGUiLCJub3ciLCJub3QiLCJ0b0JlTnVsbCIsImNob3JkIiwicHJpbWFyeU5hbWUiLCJzY29yZSIsInRvQmVMZXNzVGhhbiIsInRvQmVHcmVhdGVyVGhhbiIsInRvQmVDbG9zZVRvIiwidGltZXN0YW1wIl0sInNvdXJjZXMiOlsiY2hvcmRNYXRjaGluZy50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNob3JkcyB9IGZyb20gJy4uLy4uL3NyYy9jb25zdGFudHMvY2hvcmRzJztcbmltcG9ydCB7XG4gIEZMQVRfVE9fU0hBUlAsXG4gIG5vcm1hbGl6ZVBpdGNoQ2xhc3MsXG4gIG1hdGNoQ2hvcmRGcm9tTm90ZXMsXG59IGZyb20gJy4uLy4uL3NyYy91dGlscy9jaG9yZE1hdGNoaW5nJztcbmltcG9ydCB7IERldGVjdGVkUGl0Y2ggfSBmcm9tICcuLi8uLi9zcmMvdHlwZXMnO1xuXG5kZXNjcmliZSgnbm9ybWFsaXplUGl0Y2hDbGFzcycsICgpID0+IHtcbiAgaXQoJ2NvbnZlcnRzIGZsYXQgbm90ZXMgdG8gc2hhcnAgZXF1aXZhbGVudHMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ0RiJykpLnRvQmUoJ0MjJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ0ViJykpLnRvQmUoJ0QjJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ0diJykpLnRvQmUoJ0YjJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ0FiJykpLnRvQmUoJ0cjJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ0JiJykpLnRvQmUoJ0EjJyk7XG4gIH0pO1xuXG4gIGl0KCdyZXR1cm5zIG5hdHVyYWwgbm90ZXMgdW5jaGFuZ2VkJywgKCkgPT4ge1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdDJykpLnRvQmUoJ0MnKTtcbiAgICBleHBlY3Qobm9ybWFsaXplUGl0Y2hDbGFzcygnRCcpKS50b0JlKCdEJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ0UnKSkudG9CZSgnRScpO1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdGJykpLnRvQmUoJ0YnKTtcbiAgICBleHBlY3Qobm9ybWFsaXplUGl0Y2hDbGFzcygnRycpKS50b0JlKCdHJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ0EnKSkudG9CZSgnQScpO1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdCJykpLnRvQmUoJ0InKTtcbiAgfSk7XG5cbiAgaXQoJ3JldHVybnMgc2hhcnAgbm90ZXMgdW5jaGFuZ2VkJywgKCkgPT4ge1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdDIycpKS50b0JlKCdDIycpO1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdEIycpKS50b0JlKCdEIycpO1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdGIycpKS50b0JlKCdGIycpO1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdHIycpKS50b0JlKCdHIycpO1xuICAgIGV4cGVjdChub3JtYWxpemVQaXRjaENsYXNzKCdBIycpKS50b0JlKCdBIycpO1xuICB9KTtcblxuICBpdCgnaGFuZGxlcyBsb3dlcmNhc2UgaW5wdXQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ2RiJykpLnRvQmUoJ0MjJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ2ViJykpLnRvQmUoJ0QjJyk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBpdGNoQ2xhc3MoJ2MnKSkudG9CZSgnQycpO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnRkxBVF9UT19TSEFSUCcsICgpID0+IHtcbiAgaXQoJ2NvbnRhaW5zIGFsbCBmbGF0IHRvIHNoYXJwIG1hcHBpbmdzJywgKCkgPT4ge1xuICAgIGV4cGVjdChGTEFUX1RPX1NIQVJQKS50b0VxdWFsKHtcbiAgICAgIERiOiAnQyMnLFxuICAgICAgRWI6ICdEIycsXG4gICAgICBGYjogJ0UnLFxuICAgICAgR2I6ICdGIycsXG4gICAgICBBYjogJ0cjJyxcbiAgICAgIEJiOiAnQSMnLFxuICAgICAgQ2I6ICdCJyxcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ21hdGNoQ2hvcmRGcm9tTm90ZXMnLCAoKSA9PiB7XG4gIGNvbnN0IGNyZWF0ZVBpdGNoZXMgPSAobm90ZXM6IHN0cmluZ1tdKTogRGV0ZWN0ZWRQaXRjaFtdID0+IHtcbiAgICByZXR1cm4gbm90ZXMubWFwKChub3RlLCBpbmRleCkgPT4gKHtcbiAgICAgIG5vdGUsXG4gICAgICBmcmVxdWVuY3k6IDQ0MCArIGluZGV4ICogMTAwLFxuICAgICAgY29uZmlkZW5jZTogMC45LFxuICAgIH0pKTtcbiAgfTtcblxuICBpdCgnbWF0Y2hlcyBleGFjdCBjaG9yZCBub3RlcyB0byBhIGNob3JkJywgKCkgPT4ge1xuICAgIC8vIEMgbWFqb3I6IEMsIEUsIEdcbiAgICBjb25zdCBwaXRjaGVzID0gY3JlYXRlUGl0Y2hlcyhbJ0MnLCAnRScsICdHJ10pO1xuICAgIGNvbnN0IHJlc3VsdCA9IG1hdGNoQ2hvcmRGcm9tTm90ZXMocGl0Y2hlcywgY2hvcmRzLCBEYXRlLm5vdygpKTtcblxuICAgIGV4cGVjdChyZXN1bHQpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChyZXN1bHQ/LmNob3JkLnByaW1hcnlOYW1lKS50b0JlKCdDJyk7XG4gICAgZXhwZWN0KHJlc3VsdD8uc2NvcmUpLnRvQmUoMSk7IC8vIFBlcmZlY3QgbWF0Y2hcbiAgfSk7XG5cbiAgaXQoJ3JldHVybnMgbnVsbCB3aGVuIG5vIHBpdGNoZXMgZGV0ZWN0ZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gbWF0Y2hDaG9yZEZyb21Ob3RlcyhbXSwgY2hvcmRzLCBEYXRlLm5vdygpKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICB9KTtcblxuICBpdCgncmV0dXJucyBudWxsIHdoZW4gbm90ZXMgZG8gbm90IG1hdGNoIGFueSBjaG9yZCB3ZWxsJywgKCkgPT4ge1xuICAgIC8vIE5vdGVzIHRoYXQgZG9uJ3QgZm9ybSBhbnkgcmVjb2duaXphYmxlIGNob3JkIHBhdHRlcm5cbiAgICAvLyBVc2luZyBvbmx5IG9uZSBub3RlIC0gd29uJ3QgcmVhY2ggNTAlIHRocmVzaG9sZCBmb3IgMysgbm90ZSBjaG9yZHNcbiAgICAvLyBhbmQgd29uJ3QgbWF0Y2ggcG93ZXIgY2hvcmRzICh3aGljaCBuZWVkIDIgc3BlY2lmaWMgbm90ZXMpXG4gICAgY29uc3QgcGl0Y2hlcyA9IGNyZWF0ZVBpdGNoZXMoWydDIyddKTtcbiAgICBjb25zdCByZXN1bHQgPSBtYXRjaENob3JkRnJvbU5vdGVzKHBpdGNoZXMsIGNob3JkcywgRGF0ZS5ub3coKSk7XG5cbiAgICAvLyBTaW5nbGUgbm90ZSBDIyB3b24ndCBtYXRjaCA1MCUgb2YgYW55IGNob3JkIChldmVuIHBvd2VyIGNob3JkcyBuZWVkIDIgbm90ZXMpXG4gICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcbiAgfSk7XG5cbiAgaXQoJ2hhbmRsZXMgZmxhdCBub3RlcyBieSBub3JtYWxpemluZyB0byBzaGFycHMnLCAoKSA9PiB7XG4gICAgLy8gRiBtaW5vciBjb250YWlucyBBYiB3aGljaCBzaG91bGQgYmUgbm9ybWFsaXplZCB0byBHI1xuICAgIC8vIEZtOiBGLCBBYiwgQyAtPiBGLCBHIywgQ1xuICAgIGNvbnN0IHBpdGNoZXMgPSBjcmVhdGVQaXRjaGVzKFsnRicsICdBYicsICdDJ10pO1xuICAgIGNvbnN0IHJlc3VsdCA9IG1hdGNoQ2hvcmRGcm9tTm90ZXMocGl0Y2hlcywgY2hvcmRzLCBEYXRlLm5vdygpKTtcblxuICAgIGV4cGVjdChyZXN1bHQpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChyZXN1bHQ/LmNob3JkLnByaW1hcnlOYW1lKS50b0JlKCdGbScpO1xuICB9KTtcblxuICBpdCgnY2FsY3VsYXRlcyBzY29yZSBiYXNlZCBvbiBub3RlIG92ZXJsYXAnLCAoKSA9PiB7XG4gICAgLy8gRCBtYWpvcjogRCwgRiMsIEEgLSBidXQgd2Ugb25seSBkZXRlY3QgRCBhbmQgRiNcbiAgICBjb25zdCBwaXRjaGVzID0gY3JlYXRlUGl0Y2hlcyhbJ0QnLCAnRiMnXSk7XG4gICAgY29uc3QgcmVzdWx0ID0gbWF0Y2hDaG9yZEZyb21Ob3RlcyhwaXRjaGVzLCBjaG9yZHMsIERhdGUubm93KCkpO1xuXG4gICAgLy8gU2hvdWxkIG1hdGNoIEQgbWFqb3Igd2l0aCAyLzMgbm90ZXMgPSAwLjY3IHNjb3JlXG4gICAgZXhwZWN0KHJlc3VsdCkubm90LnRvQmVOdWxsKCk7XG4gICAgLy8gU2NvcmUgc2hvdWxkIGJlIGxlc3MgdGhhbiAxIHNpbmNlIG5vdCBhbGwgbm90ZXMgZGV0ZWN0ZWRcbiAgICBleHBlY3QocmVzdWx0IS5zY29yZSkudG9CZUxlc3NUaGFuKDEpO1xuICAgIGV4cGVjdChyZXN1bHQhLnNjb3JlKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgLy8gMiBvdXQgb2YgMyBub3RlcyBmb3IgRCBtYWpvclxuICAgIGV4cGVjdChyZXN1bHQhLnNjb3JlKS50b0JlQ2xvc2VUbygyIC8gMywgMik7XG4gIH0pO1xuXG4gIGl0KCdpbmNsdWRlcyB0aW1lc3RhbXAgaW4gdGhlIHJlc3VsdCcsICgpID0+IHtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSAxMjM0NTY3ODkwO1xuICAgIGNvbnN0IHBpdGNoZXMgPSBjcmVhdGVQaXRjaGVzKFsnQycsICdFJywgJ0cnXSk7XG4gICAgY29uc3QgcmVzdWx0ID0gbWF0Y2hDaG9yZEZyb21Ob3RlcyhwaXRjaGVzLCBjaG9yZHMsIHRpbWVzdGFtcCk7XG5cbiAgICBleHBlY3QocmVzdWx0Py50aW1lc3RhbXApLnRvQmUodGltZXN0YW1wKTtcbiAgfSk7XG5cbiAgaXQoJ3ByZWZlcnMgY2hvcmRzIHdpdGggaGlnaGVyIG92ZXJsYXAgc2NvcmVzJywgKCkgPT4ge1xuICAgIC8vIEcgbWFqb3I6IEcsIEIsIERcbiAgICAvLyBFbTogRSwgRywgQlxuICAgIC8vIElmIHdlIGRldGVjdCBHLCBCIHdlIHNob3VsZCBnZXQgb25lIG9mIHRoZXNlXG4gICAgY29uc3QgcGl0Y2hlcyA9IGNyZWF0ZVBpdGNoZXMoWydHJywgJ0InLCAnRCddKTtcbiAgICBjb25zdCByZXN1bHQgPSBtYXRjaENob3JkRnJvbU5vdGVzKHBpdGNoZXMsIGNob3JkcywgRGF0ZS5ub3coKSk7XG5cbiAgICBleHBlY3QocmVzdWx0KS5ub3QudG9CZU51bGwoKTtcbiAgICBleHBlY3QocmVzdWx0Py5jaG9yZC5wcmltYXJ5TmFtZSkudG9CZSgnRycpO1xuICAgIGV4cGVjdChyZXN1bHQ/LnNjb3JlKS50b0JlKDEpO1xuICB9KTtcblxuICBpdCgnaGFuZGxlcyBkdXBsaWNhdGUgZGV0ZWN0ZWQgbm90ZXMnLCAoKSA9PiB7XG4gICAgLy8gTXVsdGlwbGUgb2N0YXZlcyBvZiB0aGUgc2FtZSBub3RlXG4gICAgY29uc3QgcGl0Y2hlcyA9IGNyZWF0ZVBpdGNoZXMoWydDJywgJ0UnLCAnRycsICdDJywgJ0UnXSk7XG4gICAgY29uc3QgcmVzdWx0ID0gbWF0Y2hDaG9yZEZyb21Ob3RlcyhwaXRjaGVzLCBjaG9yZHMsIERhdGUubm93KCkpO1xuXG4gICAgZXhwZWN0KHJlc3VsdCkubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHJlc3VsdD8uY2hvcmQucHJpbWFyeU5hbWUpLnRvQmUoJ0MnKTtcbiAgfSk7XG5cbiAgaXQoJ2ZpbHRlcnMgbG93IGNvbmZpZGVuY2UgcGl0Y2hlcycsICgpID0+IHtcbiAgICBjb25zdCBwaXRjaGVzOiBEZXRlY3RlZFBpdGNoW10gPSBbXG4gICAgICB7IG5vdGU6ICdDJywgZnJlcXVlbmN5OiAyNjEuNjMsIGNvbmZpZGVuY2U6IDAuOSB9LFxuICAgICAgeyBub3RlOiAnRScsIGZyZXF1ZW5jeTogMzI5LjYzLCBjb25maWRlbmNlOiAwLjkgfSxcbiAgICAgIHsgbm90ZTogJ0cnLCBmcmVxdWVuY3k6IDM5Mi4wLCBjb25maWRlbmNlOiAwLjkgfSxcbiAgICAgIHsgbm90ZTogJ1gnLCBmcmVxdWVuY3k6IDEwMCwgY29uZmlkZW5jZTogMC4xIH0sIC8vIExvdyBjb25maWRlbmNlLCBzaG91bGQgYmUgaWdub3JlZFxuICAgIF07XG4gICAgY29uc3QgcmVzdWx0ID0gbWF0Y2hDaG9yZEZyb21Ob3RlcyhwaXRjaGVzLCBjaG9yZHMsIERhdGUubm93KCkpO1xuXG4gICAgZXhwZWN0KHJlc3VsdCkubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHJlc3VsdD8uY2hvcmQucHJpbWFyeU5hbWUpLnRvQmUoJ0MnKTtcbiAgfSk7XG5cbiAgaXQoJ3JlcXVpcmVzIG1pbmltdW0gY29uZmlkZW5jZSB0aHJlc2hvbGQnLCAoKSA9PiB7XG4gICAgY29uc3QgcGl0Y2hlczogRGV0ZWN0ZWRQaXRjaFtdID0gW1xuICAgICAgeyBub3RlOiAnQycsIGZyZXF1ZW5jeTogMjYxLjYzLCBjb25maWRlbmNlOiAwLjMgfSxcbiAgICAgIHsgbm90ZTogJ0UnLCBmcmVxdWVuY3k6IDMyOS42MywgY29uZmlkZW5jZTogMC4zIH0sXG4gICAgICB7IG5vdGU6ICdHJywgZnJlcXVlbmN5OiAzOTIuMCwgY29uZmlkZW5jZTogMC4zIH0sXG4gICAgXTtcbiAgICBjb25zdCByZXN1bHQgPSBtYXRjaENob3JkRnJvbU5vdGVzKHBpdGNoZXMsIGNob3JkcywgRGF0ZS5ub3coKSwgMC41KTtcblxuICAgIC8vIEFsbCBwaXRjaGVzIGJlbG93IHRocmVzaG9sZCwgc2hvdWxkIHJldHVybiBudWxsXG4gICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBQUEsT0FBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsY0FBQSxHQUFBRCxPQUFBO0FBT0FFLFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSxZQUFNO0VBQ3BDQyxFQUFFLENBQUMsMENBQTBDLEVBQUUsWUFBTTtJQUNuREMsTUFBTSxDQUFDLElBQUFDLGtDQUFtQixFQUFDLElBQUksQ0FBQyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDNUNGLE1BQU0sQ0FBQyxJQUFBQyxrQ0FBbUIsRUFBQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDO0lBQzVDRixNQUFNLENBQUMsSUFBQUMsa0NBQW1CLEVBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQztJQUM1Q0YsTUFBTSxDQUFDLElBQUFDLGtDQUFtQixFQUFDLElBQUksQ0FBQyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDNUNGLE1BQU0sQ0FBQyxJQUFBQyxrQ0FBbUIsRUFBQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDO0VBQzlDLENBQUMsQ0FBQztFQUVGSCxFQUFFLENBQUMsaUNBQWlDLEVBQUUsWUFBTTtJQUMxQ0MsTUFBTSxDQUFDLElBQUFDLGtDQUFtQixFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUNDLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDMUNGLE1BQU0sQ0FBQyxJQUFBQyxrQ0FBbUIsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsR0FBRyxDQUFDO0lBQzFDRixNQUFNLENBQUMsSUFBQUMsa0NBQW1CLEVBQUMsR0FBRyxD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QUMxQixJQUFJLENBQUMsR0FBRyxDQUFDO0VBQzdDLENBQUMsQ0FBQztFQUVGSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsWUFBTTtJQUN6QyxJQUFNb0IsT0FBd0IsR0FBRyxDQUMvQjtNQUFFSixJQUFJLEVBQUUsR0FBRztNQUFFRSxTQUFTLEVBQUUsTUFBTTtNQUFFQyxVQUFVLEVBQUU7SUFBSSxDQUFDLEVBQ2pEO01BQUVILElBQUksRUFBRSxHQUFHO01BQUVFLFNBQVMsRUFBRSxNQUFNO01BQUVDLFVBQVUsRUFBRTtJQUFJLENBQUMsRUFDakQ7TUFBRUgsSUFBSSxFQUFFLEdBQUc7TUFBRUUsU0FBUyxFQUFFLEtBQUs7TUFBRUMsVUFBVSxFQUFFO0lBQUksQ0FBQyxFQUNoRDtNQUFFSCxJQUFJLEVBQUUsR0FBRztNQUFFRSxTQUFTLEVBQUUsR0FBRztNQUFFQyxVQUFVLEVBQUU7SUFBSSxDQUFDLENBQy9DO0lBQ0QsSUFBTUUsTUFBTSxHQUFHLElBQUFDLGtDQUFtQixFQUFDRixPQUFPLEVBQUVHLGNBQU0sRUFBRUMsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBRS9EeEIsTUFBTSxDQUFDb0IsTUFBTSxDQUFDLENBQUNLLEdBQUcsQ0FBQ0MsUUFBUSxDQUFDLENBQUM7SUFDN0IxQixNQUFNLENBQUNvQixNQUFNLG9CQUFOQSxNQUFNLENBQUVPLEtBQUssQ0FBQ0MsV0FBVyxDQUFDLENBQUMxQixJQUFJLENBQUMsR0FBRyxDQUFDO0VBQzdDLENBQUMsQ0FBQztFQUVGSCxFQUFFLENBQUMsdUNBQXVDLEVBQUUsWUFBTTtJQUNoRCxJQUFNb0IsT0FBd0IsR0FBRyxDQUMvQjtNQUFFSixJQUFJLEVBQUUsR0FBRztNQUFFRSxTQUFTLEVBQUUsTUFBTTtNQUFFQyxVQUFVLEVBQUU7SUFBSSxDQUFDLEVBQ2pEO01BQUVILElBQUksRUFBRSxHQUFHO01BQUVFLFNBQVMsRUFBRSxNQUFNO01BQUVDLFVBQVUsRUFBRTtJQUFJLENBQUMsRUFDakQ7TUFBRUgsSUFBSSxFQUFFLEdBQUc7TUFBRUUsU0FBUyxFQUFFLEtBQUs7TUFBRUMsVUFBVSxFQUFFO0lBQUksQ0FBQyxDQUNqRDtJQUNELElBQU1FLE1BQU0sR0FBRyxJQUFBQyxrQ0FBbUIsRUFBQ0YsT0FBTyxFQUFFRyxjQUFNLEVBQUVDLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUM7SUFHcEV4QixNQUFNLENBQUNvQixNQUFNLENBQUMsQ0FBQ00sUUFBUSxDQUFDLENBQUM7RUFDM0IsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119